<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Colorgy</title>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track' => true %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
    <%= csrf_meta_tags %>

    <style type="text/css">

      body {
        padding-top: 50px;
        padding-bottom: 20px;
      }

      .navbar-brand > img {
        height: 100%;
      }

      .home-btn {
        background-color: #28A38C;
        color: #fff;
        border: 0px;
        transition: background-color 0.3s;
      }

      .home-btn:hover {
        background-color: #E77B2D;
        color: #fff;
      }

      .fb-login-btn {
        background-color: #3B579D;
        color: #ffffff;
        padding: 10px 15px 10px 15px;
        border-radius: 10px;
        transition: transform 0.3s , border-radius 0.5s;
        font-size: 21px;
      }

      .fb-login-btn:hover {
        transform: scale(1.1);
        border-radius: 0px;
      }

      .fb-login-btn > a {
        color: #ffffff;
        font-size: 18px;
        left: calc( 50% - 90px );
        position: relative;
      }

      .flash-messages {
        position: absolute;
        width: 100%;
        padding-top: 24px;
      }

    </style>
  </head>

  <body>
    <!--navigation bar-->
<div class="navigation_bar fixed-nav">
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="<%= root_path %>">
          <img class="nav-logo" src="/assets/header_nav_logo.png">
        </a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">

          <% if !current_user.blank? %>
              <li>
                <%= link_to("我的帳號", "#{ENV['CORE_URL']}/my_account/emails") %>
              </li>
          <% end %>
          <li>
            <%= link_to("Colorgy Books", 'http://books.colorgy.io') %>
          </li>
        </ul>
    <div class="checkout desktop-checkout">
      <% if current_user.cart_items.present? %>
      <div class="checkout__button__number">
          <%= current_user.cart_items.count %>
      </div>
      <% end %>
      <a class="checkout__button" href="#"><!-- Fallback location -->
        <span class="checkout__text">

        </span>

      </a>
      <% if !current_user.blank? %>
      <div class="checkout__order">
        <div class="checkout__order-inner">
        <% if current_user.cart_items.present? %>
          <table class="checkout__summary">
            <thead>
                  <tr><th>書本項目</th><th>金額</th><th>課程</th><th></th></tr>
              </thead>
              <tfoot>
                  <tr><th colspan="2" class="checkout-total-th">總額 <span class="checkout__total">8000 NT</span></th></tr>
              </tfoot>
              <tbody>

              <% current_user.cart_items.each do |item| %>
              <tr><td><%= item.book_name %><span><%= item.book_author %></span></td><td><%= item.book_price %> NT</td><td><%= item.course_name %></td><td class="stickycart-delete">
              <%=link_to image_tag("stickycart-delete.png"), cart_item_path(item), method: :delete%></td></tr>
              <% end %>

            </tbody>
          </table><!-- /checkout__summary -->
          <%=link_to '我要結帳' ,cart_items_path, class:'checkout__option cart-checkout-button' %>

          <% else %>
          <p>BLANK</p>


          <% end %>
          <button class="checkout__close checkout__cancel close-button"><i class="icon fa fa-fw fa-close"></i></button>
        </div><!-- /checkout__order-inner -->
      </div><!-- /checkout__order -->
    </div><!-- /checkout -->
    <% end %>


        <ul class="nav navbar-nav navbar-right">
        <% if current_user.blank? %>
            <div class="navbar-form navbar-right">
              <%= link_to "登入 / 註冊", user_omniauth_authorize_path(:colorgy), class: 'btn btn-success home-btn' %>
            </div>
          <% else %>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="#"></a></li>
              <li>
                <%= link_to("Sign out", "#{ENV['CORE_URL']}/logout") %>
              </li>
            </ul>
          <% end %>

    <div class="profile">
      <div class="headphoto">
        <%= image_tag current_user.avatar_url %>
      </div>
      <p><%= current_user.name %></p>
      <div class="profile-field">
          <ul class="profile-field-ul">
            <a href="./profile/index.html"><li>基本資料</li></a>
            <a href="./profile/index.html"><li>聯絡我們</li></a>
            <a href="./order-tracking.html"><li>訂單查詢</li></a>
            <a href="./profile/index.html"><li>我的通知</li></a>
            <a href="./mainjew_page.html"><li>你揪的團</li></a>
            <a href="#"><li>登出</li></a>
          </ul>
      </div>
    </div>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
  </nav>
</div>
<div class="flash-messages">
      <div class="container">
        <% flash.each do |type, message| %>
          <div class="alert alert-dismissible <%= (type == :alert) ? 'alert-danger' : 'alert-info' %>" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <%= message %>
          </div>
        <% end %>
      </div>
</div>



<div class="checkout mobile-checkout">
        <% if current_user.cart_items.present? %>
        <div class="checkout__button__number">
            4
        </div>
        <% end %>
        <a class="checkout__button" href="#"><!-- Fallback location -->

          <span class="checkout__text">

          </span>
        </a>
        <div class="checkout__order">
          <div class="checkout__order-inner">
            <table class="checkout__summary">
              <thead>
                    <tr><th>書本項目</th><th>金額</th><th>數量</th></tr>
                </thead>
                <tfoot>
                    <tr><th colspan="2" class="checkout-total-th">總額 <span class="checkout__total">8000 NT</span></th></tr>
                </tfoot>
                <tbody>
                <tr><td>INTRODUCTION TO ELECTRIC CIRCUITS 8/E <span>8/e</span><span>Sedra Smith</span></td><td>2000 NT</td><td>x1</td></tr>
                <tr><td>INTRODUCTION TO ELECTRIC CIRCUITS 8/E <span>8/e</span><span>Sedra Smith</span></td><td>2000 NT</td><td>x1</td></tr>
                <tr><td>INTRODUCTION TO ELECTRIC CIRCUITS 8/E <span>8/e</span><span>Sedra Smith</span></td><td>2000 NT</td><td>x1</td></tr>
                <tr><td>INTRODUCTION TO ELECTRIC CIRCUITS 8/E <span>8/e</span><span>Sedra Smith</span></td><td>2000 NT</td><td>x1</td></tr>

              </tbody>
            </table><!-- /checkout__summary -->
            <button class="checkout__option checkout__option--silent checkout__cancel continue-buy"><i class="fa fa-angle-left"></i> 繼續購物...</button>

            <a href="./cart.html"><button class="checkout__option cart-checkout-button">我要結帳</button></a>

            <button class="checkout__close checkout__cancel close-button"><i class="icon fa fa-fw fa-close"></i></button>
          </div><!-- /checkout__order-inner -->
        </div><!-- /checkout__order -->
</div><!-- /checkout -->


    <%= yield %>

    <div class="container-fluid">
      <footer>
        <p><a id="uservoice-footer-contact-trigger" href="#">有問題嗎？聯繫我們！</a> &copy; Colorgy 2015</p>
      </footer>
    </div>
    <%= render "partials/uservoice" %>
    <%= javascript_tag do %>
      UserVoice.push(['addTrigger', '#uservoice-footer-contact-trigger', { mode: 'contact' }]);
    <% end %>
    <script>
        (function() {
          [].slice.call( document.querySelectorAll( '.checkout' ) ).forEach( function( el ) {
            var openCtrl = el.querySelector( '.checkout__button' ),
              closeCtrls = el.querySelectorAll( '.checkout__cancel' );

            openCtrl.addEventListener( 'click', function(ev) {
              ev.preventDefault();
              classie.add( el, 'checkout--active' );
            } );

            [].slice.call( closeCtrls ).forEach( function( ctrl ) {
              ctrl.addEventListener( 'click', function() {
                classie.remove( el, 'checkout--active' );
              } );
            } );
          } );
        })();
      </script>
  </body>
</html>
